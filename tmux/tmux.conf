# https://man7.org/linux/man-pages/man1/tmux.1.html

# KEY BINDINGS

# General {{{
bind C-a send-prefix
unbind C-b
bind b set -g status
# }}}

# Window navigation {{{
bind w last-window 
bind c new-window -c "#{pane_current_path}" 
bind q kill-window
# }}}

# Panes navigation (vim style <c-w>) {{{
bind a last-pane
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
# }}}

# Panes splitting (vim style <c-w>) {{{
bind s split-window -v -c "#{pane_current_path}"
bind v split-window -h -c "#{pane_current_path}"
bind V split-window -fh -c "#{pane_current_path}"
bind S split-window -fv -c "#{pane_current_path}" 
# }}}

# Panes resizing (vim style <c-w>) {{{
bind -r + resize-pane -U 5 
bind -r - resize-pane -D 5
bind -r < resize-pane -L 5 
bind -r > resize-pane -R 5 
bind = next-layout
bind | resize-pane -Z 
# }}}

# Copy mode {{{
bind -T copy-mode-vi / command-prompt -iT search -p "(search up)" { send-keys -X search-backward-incremental "%%" }
bind -T copy-mode-vi ? command-prompt -iT search -p "(search down)" { send-keys -X search-forward-incremental "%%" }
bind -T copy-mode-vi "'" send -X jump-to-mark
bind -T copy-mode-vi "{" send -X -N 5 cursor-up 
bind -T copy-mode-vi "}" send -X -N 5 cursor-down
bind -T copy-mode-vi Escape send -X cancel
bind -T copy-mode-vi m send -X set-mark
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel
# }}}

# Misc {{{
bind f display-popup -E "~/.scripts/tmux-find.nu" # Find in files and open window
bind g run "~/.scripts/open-git-remote.nu" # Open git remote in browser
bind m display-popup -E "~/.scripts/bookmarks.sh" # Open bookmarks
bind t display-popup -d "#{pane_current_path}" -w 60% -h 80% # Open shell in popup
bind y display-popup -d "#{pane_current_path}" -w 80% -h 80% -E "yazi" # Open finder in popup
bind R source-file ~/.config/tmux/tmux.conf \; display-message "Reloaded ~/.config/tmux/tmux.conf"
# }}}

# OPTIONS

# Server {{{
set -s default-terminal "tmux-256color"
set -s escape-time 0 # Reduce delay when pressing prefix
set -s extended-keys on # The program inside the pane can use extended keys
set -s focus-events on # Notify applications when a pane is focused
set -s set-clipboard on # Enable system clipboard integration
set -sa terminal-features "tmux-256color:RGB"
set -sa terminal-overrides ",xterm-256color:RGB"
# }}}

# Session {{{
set -g base-index 1 # Start windows at 1
set -g default-command "${SHELL}" # Default shell
set -g detach-on-destroy off # Do not detach when the last client disconnects
set -g display-time 4000 # tmux messages are displayed for 4 seconds
set -g history-limit 50000 # Maximum number of lines held in window history.
set -g message-style fg=default,bg=default # Command prompt style
set -g mouse on # Enable mouse support
set -g prefix C-a # Set prefix to Ctrl-a
set -g renumber-windows on # Renumber windows when one is closed
set -g status-interval 3 # Update the status line every interval seconds.
set -g status-keys emacs # Use emacs-style key bindings in the status line
set -g status-left "" # Disable left status
set -g status-position bottom # Set the position of the status line.
set -g status-right "#{pane_current_path}" # Disable right status
set -g status-style "fg=#d8dee9,bg=default" # Set status line style.
set -ga update-environment "TERM" # List of environment variables to be copied to a new session
set -ga update-environment "TERM_PROGRAM" # List of environment variables to be copied to a new session
# }}}

# Window {{{
set -g copy-mode-current-match-style "fg=#3b4252,bg=#81a1c1" # Search match style in copy mode"
set -g copy-mode-mark-style "fg=#3b4252,bg=#8fbcbb" # Mark style in copy mode
set -g copy-mode-match-style "fg=#3b4252,bg=#81a1c1" # Search match style in copy mode"
set -g mode-keys vi # Use vi keys in copy mode
set -g mode-style "fg=#d8dee9,bg=#3b4252" # Selection style in copy mode
set -g pane-active-border-style "fg=#88c0d0" # Active pane border color
set -g pane-base-index 1 # Start panes at 1
set -g pane-border-style "fg=brightblack,bg=default" # Inactive pane border color
set -g popup-border-lines rounded # Popup border style
set -g popup-border-style "fg=brightblack,bg=default" # Popup border color
set -g window-status-current-style "fg=#88c0d0" # Current window color
# }}}

# Pane {{{
set -g allow-passthrough all # Allow all keys to be passed through to applications
# }}}

# vim: foldmethod=marker:foldmarker={{{,}}}:foldlevel=0
